# E2E æµ‹è¯•æŒ‡å—

## ğŸ“‹ æ¦‚è¿°

æœ¬é¡¹ç›®ä½¿ç”¨ Playwright è¿›è¡Œç«¯åˆ°ç«¯ï¼ˆE2Eï¼‰æµ‹è¯•ï¼Œåœ¨çœŸå®æµè§ˆå™¨ç¯å¢ƒä¸­éªŒè¯ç”¨æˆ·æµç¨‹ã€‚

## ğŸš€ å¿«é€Ÿå¼€å§‹

### 1. ç¡®ä¿å·²å®‰è£…ä¾èµ–

```bash
npm install
```

### 2. å¯åŠ¨å¼€å‘æœåŠ¡å™¨

**é‡è¦ï¼š** E2Eæµ‹è¯•éœ€è¦åº”ç”¨æ­£åœ¨è¿è¡Œ

```bash
# åœ¨ä¸€ä¸ªç»ˆç«¯çª—å£ä¸­å¯åŠ¨å¼€å‘æœåŠ¡å™¨
npm run dev
```

ç­‰å¾…æœåŠ¡å™¨å¯åŠ¨å®Œæˆï¼Œé€šå¸¸ä¼šæ˜¾ç¤ºï¼š
```
  âœ  Local:   http://localhost:5173/
```

### 3. è¿è¡ŒE2Eæµ‹è¯•

åœ¨å¦ä¸€ä¸ªç»ˆç«¯çª—å£ä¸­è¿è¡Œæµ‹è¯•ï¼š

```bash
# è¿è¡Œæ‰€æœ‰E2Eæµ‹è¯•
npx playwright test

# ä»¥åˆ—è¡¨æ¨¡å¼è¿è¡Œï¼ˆæ›´æ¸…æ™°çš„è¾“å‡ºï¼‰
npx playwright test --reporter=list

# è¿è¡Œç‰¹å®šçš„æµ‹è¯•æ–‡ä»¶
npx playwright test prompt-generation

# ä»¥å¯è§†åŒ–UIæ¨¡å¼è¿è¡Œï¼ˆæ¨èè°ƒè¯•æ—¶ä½¿ç”¨ï¼‰
npx playwright test --ui
```

## ğŸ“Š æŸ¥çœ‹æµ‹è¯•æŠ¥å‘Š

æµ‹è¯•å®Œæˆåï¼ŒæŸ¥çœ‹HTMLæŠ¥å‘Šï¼š

```bash
npx playwright show-report
```

è¿™ä¼šåœ¨æµè§ˆå™¨ä¸­æ‰“å¼€è¯¦ç»†çš„æµ‹è¯•æŠ¥å‘Šï¼ŒåŒ…æ‹¬ï¼š
- æµ‹è¯•ç»“æœç»Ÿè®¡
- å¤±è´¥æµ‹è¯•çš„æˆªå›¾
- å¤±è´¥æµ‹è¯•çš„è§†é¢‘å½•åˆ¶
- è¯¦ç»†çš„æ‰§è¡Œæ—¥å¿—

## ğŸ§ª æµ‹è¯•æ–‡ä»¶è¯´æ˜

### tests/e2e/prompt-generation.spec.ts
æµ‹è¯•æç¤ºè¯ä¼˜åŒ–æµç¨‹ï¼š
- UIå…ƒç´ éªŒè¯
- è®¾å¤‡ç±»å‹åˆ‡æ¢
- æç¤ºè¯è¾“å…¥åŠŸèƒ½

### tests/e2e/history-favorites.spec.ts
æµ‹è¯•å†å²è®°å½•å’Œæ”¶è—åŠŸèƒ½ï¼š
- å†å²è®°å½•åˆ—è¡¨æ˜¾ç¤º
- æ”¶è—/å–æ¶ˆæ”¶è—
- é¡µé¢å¯¼èˆª

## ğŸ“¸ æµ‹è¯•è¾“å‡º

æµ‹è¯•è¿è¡Œæ—¶ä¼šç”Ÿæˆï¼š

- **æˆªå›¾**: `test-results/screenshots/` - æµ‹è¯•è¿‡ç¨‹çš„æˆªå›¾
- **è§†é¢‘**: `test-results/` - å¤±è´¥æµ‹è¯•çš„è§†é¢‘å½•åˆ¶  
- **æŠ¥å‘Š**: `playwright-report/` - HTMLæµ‹è¯•æŠ¥å‘Š

## âš™ï¸ é…ç½®è¯´æ˜

é…ç½®æ–‡ä»¶ï¼š`playwright.config.ts`

ä¸»è¦é…ç½®ï¼š
- **baseURL**: `http://localhost:5173` - åº”ç”¨åœ°å€
- **æµè§ˆå™¨**: Chromiumï¼ˆChromeï¼‰
- **è¶…æ—¶**: é»˜è®¤30ç§’
- **é‡è¯•**: éCIç¯å¢ƒä¸é‡è¯•ï¼ŒCIç¯å¢ƒé‡è¯•2æ¬¡

## ğŸ’¡ æœ€ä½³å®è·µ

### ä½¿ç”¨Mockæ•°æ®

ç›®å‰çš„E2Eæµ‹è¯•ä½¿ç”¨æ³¨å…¥çš„Mockæ•°æ®ï¼Œé¿å…è°ƒç”¨çœŸå®çš„AI APIï¼š

```typescript
// æ³¨å…¥æµ‹è¯•æ•°æ®åˆ°LocalStorage
await page.evaluate(() => {
  const mockDesigns = [/* mock data */];
  localStorage.setItem('aidesign_history', JSON.stringify(mockDesigns));
});
```

è¿™æ ·åšçš„å¥½å¤„ï¼š
- âœ… ä¸äº§ç”ŸAPIè°ƒç”¨è´¹ç”¨
- âœ… æµ‹è¯•è¿è¡Œæ›´å¿«
- âœ… æµ‹è¯•ç»“æœæ›´å¯é¢„æµ‹
- âœ… ä¸ä¾èµ–ç½‘ç»œè¿æ¥

### æˆªå›¾å’Œè°ƒè¯•

å¦‚æœæµ‹è¯•å¤±è´¥ï¼Œæ£€æŸ¥ï¼š
1. `test-results/screenshots/` - æŸ¥çœ‹å¤±è´¥æ—¶çš„é¡µé¢çŠ¶æ€
2. `test-results/*.webm` - æŸ¥çœ‹å¤±è´¥çš„è§†é¢‘å½•åˆ¶
3. ä½¿ç”¨ `--ui` æ¨¡å¼é€æ­¥è°ƒè¯•

## ğŸ”§ å¸¸è§é—®é¢˜

### Q: æµ‹è¯•è¶…æ—¶å¤±è´¥ï¼Ÿ
**A:** ç¡®ä¿å¼€å‘æœåŠ¡å™¨æ­£åœ¨è¿è¡Œï¼Œå¹¶ä¸”å¯ä»¥è®¿é—® http://localhost:5173

### Q: æ‰¾ä¸åˆ°å…ƒç´ ï¼Ÿ
**A:** æ£€æŸ¥å…ƒç´ é€‰æ‹©å™¨æ˜¯å¦æ­£ç¡®ï¼Œå¯ä»¥ä½¿ç”¨ `--ui` æ¨¡å¼æŸ¥çœ‹å®é™…çš„DOMç»“æ„

### Q: å¦‚ä½•åªè¿è¡ŒæŸä¸ªæµ‹è¯•ï¼Ÿ
**A:** ä½¿ç”¨ `npx playwright test <filename>` æˆ–åœ¨æµ‹è¯•å‰æ·»åŠ  `.only`:
```typescript
test.only('åº”è¯¥æ˜¾ç¤ºå†å²è®°å½•', async ({ page }) => {
  // ...
});
```

## ğŸ“š æ›´å¤šèµ„æº

- [Playwrightå®˜æ–¹æ–‡æ¡£](https://playwright.dev/)
- [ç¼–å†™æµ‹è¯•](https://playwright.dev/docs/writing-tests)
- [è°ƒè¯•æŠ€å·§](https://playwright.dev/docs/debug)
- [æœ€ä½³å®è·µ](https://playwright.dev/docs/best-practices)
